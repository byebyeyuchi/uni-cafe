{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yuqiliu/Desktop/PROJECT/js-proj/jojo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yuqiliu/Desktop/PROJECT/js-proj/jojo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yuqiliu/Desktop/PROJECT/js-proj/jojo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer}from\"react\";import axios from\"axios\";import PostContext from\"./postContext\";import PostReducer from\"./postReducer\";import{GET_POST,ADD_POST,DELETE_POST,POST_ERROR,SET_CURRENT,CLEAR_CURRENT,UPDATE_POST,GET_USER_POST}from\"../type\";var PostState=function PostState(props){var initialState={posts:[],userPosts:[],current:null,error:null,loading:true};var _useReducer=useReducer(PostReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// get public posts\nvar getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/posts\");case 3:res=_context.sent;dispatch({type:GET_POST,payload:res.data});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch({type:POST_ERROR,payload:_context.t0.response.msg});case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getPost(){return _ref.apply(this,arguments);};}();// get user posts\nvar getUserPost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"/api/posts/\".concat(user.id));case 3:res=_context2.sent;dispatch({type:GET_USER_POST,payload:res.data});_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);dispatch({type:POST_ERROR,payload:_context2.t0.response.msg});case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function getUserPost(_x){return _ref2.apply(this,arguments);};}();// add post\nvar addPost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(post){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context3.prev=1;_context3.next=4;return axios.post(\"/api/posts\",post,config);case 4:res=_context3.sent;dispatch({type:ADD_POST,payload:res.data});_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);dispatch({type:POST_ERROR,payload:_context3.t0.response.msg});case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function addPost(_x2){return _ref3.apply(this,arguments);};}();// update post \nvar updatePost=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(post){var config,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context4.prev=1;_context4.next=4;return axios.put(\"/api/posts/\".concat(post._id),post,config);case 4:res=_context4.sent;dispatch({type:UPDATE_POST,payload:res.data});_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](1);dispatch({type:POST_ERROR,payload:_context4.t0.response.msg});case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[1,8]]);}));return function updatePost(_x3){return _ref4.apply(this,arguments);};}();// delete post\nvar deletePost=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return axios.delete(\"/api/posts/\".concat(id));case 3:res=_context5.sent;dispatch({type:DELETE_POST,payload:id});_context5.next=10;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](0);dispatch({type:POST_ERROR,payload:_context5.t0.response.msg});case 10:case\"end\":return _context5.stop();}}},_callee5,null,[[0,7]]);}));return function deletePost(_x4){return _ref5.apply(this,arguments);};}();var setCurrent=function setCurrent(post){dispatch({type:SET_CURRENT,payload:post});};var clearCurrent=function clearCurrent(){return dispatch({type:CLEAR_CURRENT});};return/*#__PURE__*/React.createElement(PostContext.Provider,{value:{posts:state.posts,userPosts:state.userPosts,current:state.current,error:state.error,loading:state.loading,getPost:getPost,addPost:addPost,deletePost:deletePost,updatePost:updatePost,setCurrent:setCurrent,clearCurrent:clearCurrent,getUserPost:getUserPost}},props.children);};export default PostState;","map":{"version":3,"sources":["/Users/yuqiliu/Desktop/PROJECT/js-proj/jojo/client/src/context/post/PostState.js"],"names":["React","useReducer","axios","PostContext","PostReducer","GET_POST","ADD_POST","DELETE_POST","POST_ERROR","SET_CURRENT","CLEAR_CURRENT","UPDATE_POST","GET_USER_POST","PostState","props","initialState","posts","userPosts","current","error","loading","state","dispatch","getPost","get","res","type","payload","data","response","msg","getUserPost","user","id","addPost","post","config","headers","updatePost","put","_id","deletePost","delete","setCurrent","clearCurrent","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from \"react\";\nimport axios from \"axios\";\nimport PostContext from \"./postContext\";\nimport PostReducer from \"./postReducer\";\nimport {\n   GET_POST,\n   ADD_POST,\n   DELETE_POST,\n   POST_ERROR,\n   SET_CURRENT,\n   CLEAR_CURRENT,\n   UPDATE_POST,\n   GET_USER_POST\n} from \"../type\";\n\nconst PostState = (props) => {\n   const initialState = {\n      posts: [],\n      userPosts: [],\n      current: null,\n      error: null,\n      loading: true,\n   };\n\n   const [state, dispatch] = useReducer(PostReducer, initialState);\n\n   // get public posts\n   const getPost = async () => {\n      try {\n         const res = await axios.get(\"/api/posts\");   \n         dispatch({\n            type: GET_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg\n         });\n      }\n   };\n\n   // get user posts\n   const getUserPost = async (user) => {\n      try {\n         const res = await axios.get(`/api/posts/${user.id}`);   \n         dispatch({\n            type: GET_USER_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg\n         });\n      }\n   };\n\n\n   // add post\n   const addPost = async (post) => {\n      const config = {\n         headers: {\n            \"Content-Type\": \"application/json\",\n         },\n      };\n      try {\n         const res = await axios.post(\"/api/posts\", post, config);\n         dispatch({\n            type: ADD_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg,\n         });\n      }\n   };\n\n   // update post \n   const updatePost = async (post) => {\n      const config = {\n         headers: {\n            \"Content-Type\": \"application/json\",\n         },\n      };\n      try {\n         const res = await axios.put(`/api/posts/${post._id}`, post, config);\n         dispatch({\n            type: UPDATE_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg,\n         });\n      }\n   };\n\n\n   // delete post\n   const deletePost = async (id) => {\n      try {\n         const res = await axios.delete(`/api/posts/${id}`);\n         dispatch({\n            type: DELETE_POST,\n            payload: id,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg,\n         });\n      }\n   };\n\n   const setCurrent = (post) => {\n      dispatch({\n         type: SET_CURRENT,\n         payload: post,\n      });\n   }\n   const clearCurrent = () => dispatch({type:CLEAR_CURRENT});\n\n   return (\n      <PostContext.Provider\n         value={{\n            posts: state.posts,\n            userPosts: state.userPosts,\n            current: state.current,\n            error: state.error,\n            loading: state.loading,\n            getPost,\n            addPost,\n            deletePost,\n            updatePost,\n            setCurrent,\n            clearCurrent,\n            getUserPost\n         }}\n      >\n         {props.children}\n      </PostContext.Provider>\n   );\n};\n\nexport default PostState;\n"]},"metadata":{},"sourceType":"module"}