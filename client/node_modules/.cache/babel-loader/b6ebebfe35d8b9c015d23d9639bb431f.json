{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yuqiliu/Desktop/jojo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yuqiliu/Desktop/jojo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yuqiliu/Desktop/jojo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer}from\"react\";import axios from\"axios\";import PostContext from\"./postContext\";import PostReducer from\"./postReducer\";import{GET_POST,ADD_POST,DELETE_POST,POST_ERROR,SET_CURRENT,CLEAR_CURRENT,UPDATE_POST}from\"../type\";var PostState=function PostState(props){var initialState={posts:[],userPosts:[],current:null,error:null,loading:true};var _useReducer=useReducer(PostReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// get public posts\nvar getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/posts\");case 3:res=_context.sent;dispatch({type:GET_POST,payload:res.data});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch({type:POST_ERROR,payload:_context.t0.response.msg});case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getPost(){return _ref.apply(this,arguments);};}();// add post\nvar addPost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(post){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context2.prev=1;_context2.next=4;return axios.post(\"/api/posts\",post,config);case 4:res=_context2.sent;dispatch({type:ADD_POST,payload:res.data});_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch({type:POST_ERROR,payload:_context2.t0.response.msg});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function addPost(_x){return _ref2.apply(this,arguments);};}();// update post \nvar updatePost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(post){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context3.prev=1;_context3.next=4;return axios.put(\"/api/posts/\".concat(post._id),post,config);case 4:res=_context3.sent;dispatch({type:UPDATE_POST,payload:res.data});_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);dispatch({type:POST_ERROR,payload:_context3.t0.response.msg});case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function updatePost(_x2){return _ref3.apply(this,arguments);};}();// delete post\nvar deletePost=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){var res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.delete(\"/api/posts/\".concat(id));case 3:res=_context4.sent;dispatch({type:DELETE_POST,payload:id});_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);dispatch({type:POST_ERROR,payload:_context4.t0.response.msg});case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function deletePost(_x3){return _ref4.apply(this,arguments);};}();var setCurrent=function setCurrent(post){dispatch({type:SET_CURRENT,payload:post});};var clearCurrent=function clearCurrent(){return dispatch({type:CLEAR_CURRENT});};return/*#__PURE__*/React.createElement(PostContext.Provider,{value:{posts:state.posts,userPosts:state.userPosts,current:state.current,error:state.error,loading:state.loading,getPost:getPost,addPost:addPost,deletePost:deletePost,updatePost:updatePost,setCurrent:setCurrent,clearCurrent:clearCurrent}},props.children);};export default PostState;","map":{"version":3,"sources":["/Users/yuqiliu/Desktop/jojo/client/src/context/post/PostState.js"],"names":["React","useReducer","axios","PostContext","PostReducer","GET_POST","ADD_POST","DELETE_POST","POST_ERROR","SET_CURRENT","CLEAR_CURRENT","UPDATE_POST","PostState","props","initialState","posts","userPosts","current","error","loading","state","dispatch","getPost","get","res","type","payload","data","response","msg","addPost","post","config","headers","updatePost","put","_id","deletePost","id","delete","setCurrent","clearCurrent","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from \"react\";\nimport axios from \"axios\";\nimport PostContext from \"./postContext\";\nimport PostReducer from \"./postReducer\";\nimport {\n   GET_POST,\n   ADD_POST,\n   DELETE_POST,\n   POST_ERROR,\n   SET_CURRENT,\n   CLEAR_CURRENT,\n   UPDATE_POST\n} from \"../type\";\n\nconst PostState = (props) => {\n   const initialState = {\n      posts: [],\n      userPosts: [],\n      current: null,\n      error: null,\n      loading: true,\n   };\n\n   const [state, dispatch] = useReducer(PostReducer, initialState);\n\n   // get public posts\n   const getPost = async () => {\n      try {\n         const res = await axios.get(\"/api/posts\");   \n         dispatch({\n            type: GET_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg\n         });\n      }\n   };\n\n   // add post\n   const addPost = async (post) => {\n      const config = {\n         headers: {\n            \"Content-Type\": \"application/json\",\n         },\n      };\n      try {\n         const res = await axios.post(\"/api/posts\", post, config);\n         dispatch({\n            type: ADD_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg,\n         });\n      }\n   };\n\n   // update post \n   const updatePost = async (post) => {\n      const config = {\n         headers: {\n            \"Content-Type\": \"application/json\",\n         },\n      };\n      try {\n         const res = await axios.put(`/api/posts/${post._id}`, post, config);\n         dispatch({\n            type: UPDATE_POST,\n            payload: res.data,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg,\n         });\n      }\n   };\n\n\n   // delete post\n   const deletePost = async (id) => {\n      try {\n         const res = await axios.delete(`/api/posts/${id}`);\n         dispatch({\n            type: DELETE_POST,\n            payload: id,\n         });\n      } catch (err) {\n         dispatch({\n            type: POST_ERROR,\n            payload: err.response.msg,\n         });\n      }\n   };\n\n   const setCurrent = (post) => {\n      dispatch({\n         type: SET_CURRENT,\n         payload: post,\n      });\n   }\n   const clearCurrent = () => dispatch({type:CLEAR_CURRENT});\n\n   return (\n      <PostContext.Provider\n         value={{\n            posts: state.posts,\n            userPosts: state.userPosts,\n            current: state.current,\n            error: state.error,\n            loading: state.loading,\n            getPost,\n            addPost,\n            deletePost,\n            updatePost,\n            setCurrent,\n            clearCurrent\n         }}\n      >\n         {props.children}\n      </PostContext.Provider>\n   );\n};\n\nexport default PostState;\n"]},"metadata":{},"sourceType":"module"}